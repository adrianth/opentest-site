<!DOCTYPE html><html lang=""><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>JavaScript API - OpenTest</title><link href="/css/bootstrap.min.css" rel="stylesheet"><link href="/css/asciidoctor.css" rel="stylesheet"><link href="/css/italian-pop.css" rel="stylesheet"><link href="/css/pygments.css" rel="stylesheet"><link href="/css/style.css" rel="stylesheet"><link href="/css/slick.css" rel="stylesheet"><link href="/css/menu.css" rel="stylesheet"><link href="/css/home.css" rel="stylesheet"><link href="/css/footer.css" rel="stylesheet"><link rel="stylesheet" href="/css/document.css" media="screen" type="text/css"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Pragati+Narrow" rel="stylesheet"> <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script><meta name="keywords" content="opentest, javascript, api"></head><body><div id="menu-wrapper"><div class="container"><div class="row"><nav class="navbar main-menu" role="navigation"><div class="navbar-header"> <a class="navbar-brand" href="/"> <img src="/img/common/opentest.svg" /> OpenTest </a> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-navbar-collapse-1"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button></div><div class="collapse navbar-collapse" id="bs-navbar-collapse-1"><ul class="nav navbar-nav navbar-right scrollable-menu"><li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Docs <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/docs/installation.html">Installation</a></li><li><a href="/docs/architecture.html">Architecture</a></li><li><a href="/docs/test-structure.html">Test structure</a></li><li><a href="/docs/test-action-types.html">Test action types</a></li><li><a href="/docs/test-data.html">Working with test data</a></li><li><a href="/docs/passing-data.html">Passing data between test steps</a></li><li><a href="/docs/scripting-support.html">Scripting support</a></li><li><a href="/docs/data-driven-testing.html">Data-driven testing</a></li></ul></li><li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Reference <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/reference/selenium-keywords.html">Selenium keywords</a></li><li><a href="/reference/appium-keywords.html">Appium keywords</a></li><li><a href="/reference/generic-keywords.html">Generic keywords</a></li><li><a href="/reference/javascript-api.html">JavaScript API</a></li><li><a href="/reference/yaml-primer.html">YAML primer</a></li></ul></li><li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Tutorials <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/tutorials/selenium-testing.html">Web testing</a></li><li><a href="/tutorials/appium-testing.html">Mobile testing</a></li><li><a href="/tutorials/api-testing.html">REST API testing</a></li></ul></li></ul></div></nav></div></div></div><div class="clearfix"></div><div class="main-content"><div class="page-content"><div class="container"><div class="row"><div class="col-md-3 hidden-sm hidden-xs" id="toc-col"><div id="docs-toc"><h3>Docs</h3><ul class="dropdown-menu1"><li><a href="/docs/installation.html">Installation</a></li><li><a href="/docs/architecture.html">Architecture</a></li><li><a href="/docs/test-structure.html">Test structure</a></li><li><a href="/docs/test-action-types.html">Test action types</a></li><li><a href="/docs/test-data.html">Working with test data</a></li><li><a href="/docs/passing-data.html">Passing data between<br>test steps </a></li><li><a href="/docs/scripting-support.html">Scripting support</a></li><li><a href="/docs/data-driven-testing.html">Data-driven testing</a></li></ul><h3>Reference</h3><ul class="dropdown-menu1"><li><a href="/reference/selenium-keywords.html">Selenium keywords</a></li><li><a href="/reference/appium-keywords.html">Appium keywords</a></li><li><a href="/reference/generic-keywords.html">Generic keywords</a></li><li><a href="/reference/javascript-api.html">JavaScript API</a></li><li><a href="/reference/yaml-primer.html">YAML primer</a></li></ul><h3>Tutorials</h3><ul class="dropdown-menu1"><li><a href="/tutorials/selenium-testing.html">Web testing</a></li><li><a href="/tutorials/appium-testing.html">Mobile testing</a></li><li><a href="/tutorials/api-testing.html">REST API testing</a></li></ul></div></div><div class="col-sm-9"><h1>JavaScript API</h1><div class="toc-container"> <span class="toc-heading">Contents</span><ul class="sectlevel1"><li><a href="#overview">Overview</a></li><li><a href="#api-list">API list</a><ul class="sectlevel2"><li><a href="#array-arraylike">$array(arrayLike)</a></li><li><a href="#config-propertyname">$config(propertyName)</a></li><li><a href="#data-relativepath">$data(relativePath)</a></li><li><a href="#delay-milliseconds">$delay(milliseconds)</a></li><li><a href="#fail-message">$fail([message])</a></li><li><a href="#format-formattext-formatitems">$format(formatText, [formatItems])</a></li><li><a href="#image-relativepath">$image(relativePath)</a></li><li><a href="#json-objvalue">$json(objValue)</a></li><li><a href="#localdata-propname-propvalue">$localData(propName, [propValue])</a></li><li><a href="#log-text">$log(text)</a></li><li><a href="#macroargs-argname">$macroArgs(argName)</a></li><li><a href="#macrooutput-propname-propvalue">$macroOutput(propName, propValue)</a></li><li><a href="#random-min-max">$random(min, max)</a></li><li><a href="#randomstring-length-characterpool">$randomString(length, [characterPool])</a></li><li><a href="#readoutput-outputname">$readOutput(outputName)</a></li><li><a href="#runaction-actionname-args">$runAction(actionName, args)</a></li><li><a href="#runmacro-macroname-args">$runMacro(macroName, args)</a></li><li><a href="#sessiondata-propname-propvalue">$sessionData(propName, [propValue])</a></li><li><a href="#shareddata-propname-propvalue">$sharedData(propName, [propValue])</a></li><li><a href="#tempdir">$tempDir</a></li></ul></li></ul></div><hr><div class="sect1"><h2 id="overview">Overview</h2><div class="sectionbody"><div class="paragraph"><p>The APIs described below are available to be used in any script test action or when setting the values of test action arguments in a test file. Some APIs should only be used in a specific context (e.g. using the <code>$macroArgs</code> and <code>$macroOutput</code> APIs only makes sense in a macro action).</p></div><div class="paragraph"><p>All JavaScript APIs defined by the test actor are prefixed with <code>$</code> so they don&#8217;t conflict with user-defined functions and variables.</p></div></div></div><div class="sect1"><h2 id="api-list">API list</h2><div class="sectionbody"><div class="sect2"><h3 id="array-arraylike">$array(arrayLike)</h3><div class="paragraph"><p>Converts the provided argument to a native JavaScript array. Useful when we need to quickly and easily convert a Java collection type to a JS array, so we can access the JavaScript Array APIs (<code>map()</code>, <code>filter()</code>, etc.)</p></div><div class="paragraph"><p>The <code>$array()</code> function can currently handle Java arrays and objects implementing the <code>List</code> interface. When a different type of object is passed to this function, it will return a new JS array that has the provided object as its only element.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    var ArrayList = Java.type("java.util.ArrayList");

    var myList = new ArrayList();
    myList.add("red");
    myList.add("green");
    myList.add("blue");

    // To use the JS-native Array.join(), we need to first
    // pass the ArrayList instance through $array()
    var colors = $array(myList).join(", ");
    $log("The colors are " + colors);</code></pre></div></div></div><div class="sect2"><h3 id="config-propertyname">$config(propertyName)</h3><div class="paragraph"><p>Reads and returns a configuration property from the test actor configuration file ("actor.yaml"). Properties located at level 2 or deeper in the document hierarchy can be read using dot notation. If the specified property doesn&#8217;t exist, the returned value will be <code>null</code>.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    var browserName = $config("selenium.desiredCapabilities.browserName");</code></pre></div></div></div><div class="sect2"><h3 id="data-relativepath">$data(relativePath)</h3><div class="paragraph"><p>Reads a YAML or CSV data file in the test repository and returns a JavaScript object that represents the contents of the data file. The <code>relativePath</code> parameter is the path to the data file, relative to the <code>data</code> directory in the test repository. For YAML files, specifying the <code>.yaml</code> extension is optional. For example, let&#8217;s assume we have a data file named <code>person.yaml</code> located directly in the <code>test-repo-path/data</code> directory that stores details about a person, with the following content:</p></div><div class="listingblock"><div class="title">test-repo-path/data/person.yaml</div><div class="content"><pre class="pygments highlight"><code>name: John Doe
address:
  city: Oak Brook
  zipCode: 60532</code></pre></div></div><div class="paragraph"><p>In this case the following syntax can be used in a script action to make use of the data in this file:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    $log($data("person").name); // John Doe
    $log($data("person").address.zipCode); // 60532</code></pre></div></div><div class="paragraph"><p>Please note that, when using the "environments" feature, the data files in the <code>data</code> directory will be overridden by the data files in the environment we are currently running in, if a data file with that name is present for that environment. More details in the documentation of the "environments" feature.</p></div></div><div class="sect2"><h3 id="delay-milliseconds">$delay(milliseconds)</h3><div class="paragraph"><p>Makes the test actor wait for the number of milliseconds specified.</p></div><div class="paragraph"><p>As a best practice, avoid using this API, unless you absolutely have to. Instead, rely on the logic incorporated into the Selenium and Appium keywords, which automatically waits for an element to become visible in the current page or screen. This way, you avoid introducing unnecessary wait times and improve execution speed.</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: $delay(2000); // Wait for two seconds</code></pre></div></div></div><div class="sect2"><h3 id="fail-message">$fail([message])</h3><div class="paragraph"><p>Fails the current test. If the <code>message</code> parameter is provided, it will appear in the stack trace, so you should always take the time to formulate a concise description that clearly explains the reason a test got failed, to make it easy for yourself and others to understand the root cause for the failure when looking at the test execution reports and/or logs.</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    if (person.name != "John Doe") {
        $fail(
            "We expected the name to be John Doe, " +
            "but we found " + person.name);
    }</code></pre></div></div></div><div class="sect2"><h3 id="format-formattext-formatitems">$format(formatText, [formatItems])</h3><div class="paragraph"><p>Utility function for string formatting. Works similarly with <code>String.format()</code> in Java or <code>printf()</code> in C, except the placeholders are consecutive numbers between curly braces (<code>{0}</code>, <code>{1}</code>, etc.)</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    format("{0}, {1}!", "Hello", "world")   // "Hello, world!"</code></pre></div></div></div><div class="sect2"><h3 id="image-relativepath">$image(relativePath)</h3><div class="paragraph"><p>Returns an image object of type <code>BufferedImage</code>. The argument is the relative path to the image in the "images" directory of the test repository. This function is intended to be used for supplying argument values for test actions that take image arguments.</p></div></div><div class="sect2"><h3 id="json-objvalue">$json(objValue)</h3><div class="paragraph"><p>Converts the specified JavaScript value to a JSON string. This function is roughly equivalent with the JavaScript function <code>JSON.stringify()</code> and it&#8217;s the recommended way to serialize objects to JSON in OpenTest.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- description: Make an HTTP request with a JSON payload
  action: org.getopentest.actions.HttpRequest
  args:
    url: http://some.url.com
    verb: POST
    contentType: application/json
    body: |
      $json(
        {
          "prop1": "value1",
          "prop2": "value2"
        }
      )</code></pre></div></div></div><div class="sect2"><h3 id="localdata-propname-propvalue">$localData(propName, [propValue])</h3><div class="paragraph"><p>Reads or writes data to/from the actor&#8217;s local data store. Properties written in the local data store are only readable by the test actor that created them. In other words, other actors that are part of the same test will not be able to access each other&#8217;s local data. If you need to share data between test actors, see <code>$sharedData</code> and <code>$sessionData</code> instead. Internally, the local data store is just a Java HashMap managed by each test actor.</p></div><div class="paragraph"><p>Example 1:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    // Use the "$localData" function to write a value in the
    // local data store, under the property name "customer"
    $localData("customer", "John Doe");

    // Read the value of the "customer" property
    // and write it to the log
    $log($localData("name"));</code></pre></div></div><div class="paragraph"><p>Example 2 (writing a property into local data by means of using the <code>$localData</code> global argument):</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- description: |
    Read the current page source and store it in local
    data under the "pageSource" property name
  action: org.getopentest.selenium.ReadPageSource
  args:
    $localData:
        pageSource: $readOutput("pageSource")

- description: Log the page source
  script: |
    $log("The page source is " + $localData("pageSource"));</code></pre></div></div></div><div class="sect2"><h3 id="log-text">$log(text)</h3><div class="paragraph"><p>Logs a line of text in the context of the current test session, at log level "informational". To log to other log levels, use the syntax <code>$log.error()</code>, <code>$log.debug()</code> and <code>$log.trace()</code>.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>$log("This is an informational message");
$log.error("This is an error message");</code></pre></div></div></div><div class="sect2"><h3 id="macroargs-argname">$macroArgs(argName)</h3><div class="paragraph"><p>Reads the value of an argument that was passed to a macro test action. Can be used inside of macro actions to read the value that was passed for a particular argument when the action was called from a test file. If the argument by with the specified name was not provided by the macro action caller, the value returned will be null.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="title">test-repo-path/macros/SampleMacroAction</div><div class="content"><pre class="pygments highlight"><code>- description: |
    Display a greeting to the person specified in the "name" argument
  actions:
    - script: |
        var name = $macroArgs("name");
        $log("Hello, " + name + "!");</code></pre></div></div></div><div class="sect2"><h3 id="macrooutput-propname-propvalue">$macroOutput(propName, propValue)</h3><div class="paragraph"><p>Writes an output value for a macro action. Can be used inside of the macro action code to create output values that will be returned to the caller of the macro action.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="title">test-repo-path/macros/SampleMacroAction</div><div class="content"><pre class="pygments highlight"><code>- description: |
    Output a greeting text to the caller, under the
    output name "greeting"
  actions:
    - script: $macroOuptut("greeting", "Hello there!")</code></pre></div></div></div><div class="sect2"><h3 id="random-min-max">$random(min, max)</h3><div class="paragraph"><p>Returns a random integer number between min and max.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>$random(1, 100); // 87</code></pre></div></div></div><div class="sect2"><h3 id="randomstring-length-characterpool">$randomString(length, [characterPool])</h3><div class="paragraph"><p>Returns a random string with the specified length by randomly selecting characters from the character pool provided. If the character pool argument is missing, the default pool will be formed of all numbers and letters (both uppercase and lowercase).</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>$randomString(5);            // 2U8cM
$randomString(5, "ABC123");  // AB2AC</code></pre></div></div></div><div class="sect2"><h3 id="readoutput-outputname">$readOutput(outputName)</h3><div class="paragraph"><p>Reads the value of an output property produced from a regular test action or macro action. The best practice is to use the return value of this function to populate a data property into the local data store. Later, in a subsequent test action, we can make use of this data property by reading it from the local data store using the <code>$localData</code> function.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- description: |
    Make an HTTP request to get the HTML of the Google homepage and
    write it in the local data store, under the name "homepage"
  action: org.getopentest.actions.HttpRequest
  args:
    url: https://www.google.com/
    $localData:
      homepage: $readOutput("body)

- script: |
    $log("The Google homepage code was " + $localData("homepage"));</code></pre></div></div></div><div class="sect2"><h3 id="runaction-actionname-args">$runAction(actionName, args)</h3><div class="paragraph"><p>Runs a regular test action, with the specified arguments. This will produce the exact same effect as calling the action by using the regular YAML syntax, but has the advantage that can be incorporated into JavaScript code to cover more complex scenarios, when a test action must be executed in a loop or in a complex <code>if&#8230;&#8203;else</code> statement.</p></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    var hourOfDay = (new Date()).getHours();

    if (hourOfDay &lt; 15) {
      $runAction("org.getopentest.actions.HttpRequest", {
        url: "http://restaurant.com/order/lunch"
      });
    } else {
      $runAction("org.getopentest.actions.HttpRequest", {
        url: "http://restaurant.com/order/dinner"
      });
    }</code></pre></div></div></div><div class="sect2"><h3 id="runmacro-macroname-args">$runMacro(macroName, args)</h3><div class="paragraph"><p>Runs a macro action, with the specified arguments. The name of the macro has to include the path of the macro file, relative to the "macros" directory in the test repo. For example, if we have a macro file named "PrintMyName.yaml" located in the "macros/dir/subdir" directory, the syntax to call it would be:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    $runMacro("dir.subdir.PrintMyName", {
      name: "John Doe"
    });</code></pre></div></div></div><div class="sect2"><h3 id="sessiondata-propname-propvalue">$sessionData(propName, [propValue])</h3><div class="paragraph"><p>Reads or writes data to/from the test session&#8217;s data store. Session data is stored on the sync server, which means that every time a test actor reads or writes to/from session data the actor makes an HTTP request to the sync server, which will have some impact on the execution time of the test. If the data doesn&#8217;t have to be shared with other actors, you should be using the local or shared data stores instead (see $localData and $sharedData).</p></div><div class="admonitionblock note"><table><tr><td class="icon"><div class="title">Note</div></td><td class="content"> Using session data is a bad practice, for the same reasons why using global variables is bad. Please avoid using this API, if you can - it is only provided for those 2 oddball use cases where there&#8217;s really no way around it.</td></tr></table></div><div class="paragraph"><p>Example:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    // Use the "$sessionData" function to write a value in the test
    // session's data store, under the property name "customer"
    $sessionData("customer", "John Doe");

    // Read the value of the "customer" property
    // and write it to the log
    $log($sessionData("name"));</code></pre></div></div></div><div class="sect2"><h3 id="shareddata-propname-propvalue">$sharedData(propName, [propValue])</h3><div class="paragraph"><p>Reads or writes data to/from the test-scoped data store. Shared data is stored on the sync server, which means that every time a test actor reads or writes to/from the shared data store, the actor makes an HTTP request to the sync server, which will have some impact on the execution time of the test. If the data doesn&#8217;t have to be shared with other actors, you should be using the local data store instead (see $localData).</p></div><div class="paragraph"><p>Example 1:</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- script: |
    // Use the "$sharedData" function to write a value in the
    // shared data store, under the property name "customer"
    $sharedData("customer", "John Doe");

    // Read the value of the "customer" property
    // and write it to the log
    $log($sharedData("name"));</code></pre></div></div><div class="paragraph"><p>Example 2 (writing a property into the shared data store by means of using the $sharedData global argument):</p></div><div class="listingblock"><div class="content"><pre class="pygments highlight"><code>- description: |
    Read the current URL and store it in local
    data under the "currentUrl" property name
  action: org.getopentest.selenium.ReadCurrentUrl
  args:
    $sharedData:
        currentUrl: $readOutput("url")

- description: Log the current URL
  script: |
    $log("The current URL is " + $sharedData("currentUrl"));</code></pre></div></div></div><div class="sect2"><h3 id="tempdir">$tempDir</h3><div class="paragraph"><p>String value that stores the full path to the actor&#8217;s temporary directory. Can be used to store temporary files that might need to be created during the execution of a test.</p></div></div></div></div><br><div id="disqus_thread"></div><script> (function() { var d = document, s = d.createElement('script'); s.src = 'https://getopentest.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div></div><footer><div class="container"><div class="row"><div class="col-sm-12"> <a href="#"><i class="fab fa-github"></i> GitHub</a>&nbsp; &nbsp;|&nbsp;&nbsp; <a href="https://github.com/mcdcorp/opentest/blob/master/LICENSE">MIT license</a></div></div></div></footer><script src="/js/jquery-2.2.4.min.js"></script> <script src="/js/side-toc.js"></script> <script src="/js/bootstrap.min.js"></script> <script src="/js/slick.min.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-73340843-6"></script> <script defer src="/js/analytics.js"></script></body></html>
